# **Regression task.** *(Prediction of the duration of a taxi ride in New York)*

# **Задача регрессии.** *(Прогнозирование продолжительности поездки на такси в Нью-Йорке)*

![Заголовок](./plots/head.png)

## Оглавление

1. [Описание проекта](#описание-проекта)

2. [Описание данных](#описание-данных)

3. [Зависимости](#зависимости)

4. [Установка](#установка)

5. [Использование](#использование)

6. [Авторы](#авторы)

7. [Выводы](#выводы)

# [Ссылка на Kaggle](https://www.kaggle.com/competitions/nyc-taxi-trip-duration/overview)

## Описание проекта

Задача, которую будем решать, была представлена в качестве Data Science-соревнования с призовым фондом в 30 000 $ на платформе Kaggle в 2017 году.

Предоставлен набор данных, содержащий информацию о поездках на жёлтом такси в Нью-Йорке за 2016 год. Первоначально данные были выпущены Комиссией по Такси и Лимузинам Нью-Йорка и включают в себя информацию о времени поездки, географических координатах, количестве пассажиров и несколько других переменных.

Бизнес-задача: определить характеристики и с их помощью спрогнозировать длительность поездки на такси.

Техническая задача: построить модель машинного обучения, которая на основе предложенных характеристик клиента будет предсказывать числовой признак — время поездки такси, то есть решить задачу регрессии.

**Машинное обучение** – *процесс использования математических представлений данных с целью обучения компьютера без особых инструкций.*

**Предсказание** - *использование существующего набора данных для построения модели (машинного обучения), которая предсказывает значение переменной отклика нового наблюдения.*

**Основные этапы проекта:**

1. **Первичная обработка данных**
2. **Разведывательный анализ данных (EDA)**
3. **Отбор и преобразование признаков**
4. **Решение задачи регрессии, линейная регрессия и деревья решений**
5. **Решение задачи регрессии, ансамбли моделей и построение прогноза**
6. **Дополнительно, модель экстремального градиентного бустинга (XGBoost)**

1 ***Первичная обработка данных:*** сформировать набор данных на основе предложенных источников информации, а также обработать пропуски и выбросы в данных.

2 ***Разведывательный анализ данных (EDA):***  исследовать данные, нащупать закономерности и выдвинуть гипотезы.

3 ***Отбор и преобразование признаков:*** перекодировать и преобразовать данные таким образом, чтобы их можно было использовать при решении задачи регрессии — для построения модели.

4 ***Решение задачи регрессии, линейная регрессия и деревья решений:***  построить первые прогностические модели и оценить их качество. Создать так называемый baseline, который поможет  ответить на вопрос: «Решаема ли вообще представленная задача?».

5 ***Решение задачи регрессии: ансамбли моделей и построение прогноза:*** доработать предсказание с использованием более сложных алгоритмов и оценить, с помощью какой модели возможно сделать более качественные прогнозы.

6 ***Дополнительно, модель экстремального градиентного бустинга (XGBoost)*** улучшить предсказание, воспользовавшись моделью экстремального градиентного бустинга (XGBoost) из библиотеки xgboost.

**О структуре проекта:**

* [plots](./plots) - папка с изображениями, необходимыми для проекта
* [Project_5_notebook.ipynb](./Project_5_notebook.ipynb) - jupyter-ноутбук, содержащий код проекта.

[Оглавление](#оглавление)

## Описание данных

Данные принадлежат реальному соревнованию Kaggle.

*Основной массив данных:*
- train.csv - тренеровочный сет (содержит 1458644 записи)
- test.csv - тестовый сет (содержит 625134 записи)

[Ссылка на загрузку](https://www.kaggle.com/competitions/nyc-taxi-trip-duration/data)

*Дополнительные данные*
- weather_data.csv - набор данных, содержащий информацию о погодных условиях в Нью-Йорке в 2016 году
- holiday_data.csv - даты всех праздничных дней в Америке за 2016 год
- osrm_data_train.csv - тренеровочный сет (содержит 1458644 записи) - данные из [OSRM (Open Source Routing Machine)](https://en.wikipedia.org/wiki/Open_Source_Routing_Machine#External_links)
- osrm_data_test.csv - тестовый сет (содержит 625134 записи) - данные из [OSRM (Open Source Routing Machine)](https://en.wikipedia.org/wiki/Open_Source_Routing_Machine#External_links)

[Ссылка на загрузку](https://lms-cdn.skillfactory.ru/assets/courseware/v1/0f6abf84673975634c33b0689851e8cc/asset-v1:SkillFactory+DST-3.0+28FEB2021+type@asset+block/weather_data.zip)

[Ссылка на загрузку](https://lms-cdn.skillfactory.ru/assets/courseware/v1/33bd8d5f6f2ba8d00e2ce66ed0a9f510/asset-v1:SkillFactory+DST-3.0+28FEB2021+type@asset+block/holiday_data.csv)

[Ссылка на загрузку](https://drive.google.com/file/d/1ecWjor7Tn3HP7LEAm5a0B_wrIfdcVGwR/view)

## Метрика качества

Метрикой качества является RMSLE (Root Mean Squared Log Error), корень из среднеквадратичной логарифмической ошибки.

## Зависимости

- numpy 1.23.5
- pandas 1.5.3
- matplotlib 3.7.1
- seaborn 0.12.2
- plotly 5.14.1
- scipy 1.9.3
- scikit-learn 1.3.0

## Установка

[git](https://github.com/artem-75/ ???????)

Нажать зеленую кнопку: <> Code, далее выбрать нужное (клонировать репозиторий, открыть на ПК или скачать его архив), при запуске кода в jupyter-ноутбуке необходимо учесть существующие зависимости.

Все данные необходимо скачать отдельно по указанным ссылкам и установить в подпапку data папки проекта на локальном диске.

## Использование

Вся информация о работе представлена в jupyter-ноутбуке [Project_5_notebook.ipynb](Project_5_notebook.ipynb).

## Авторы

[Артем Корнев](https://t.me/@Artem1975)

## Выводы

Создана модель, основанная на алгоритмах машинного обучения.

Значение метрики качества 0.4 - достаточное в сравнении с результатами соревнования для используемых моделей.

# [Ссылка на Kaggle](https://www.kaggle.com/competitions/nyc-taxi-trip-duration/overview)

[Оглавление](#оглавление)
